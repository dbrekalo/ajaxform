!function(t){function i(s){this.options=t.extend({},i.defaults,s),this.init()}var s=0;t.extend(i.prototype,{init:function(){this.$el="string"==typeof this.options.el?t(this.options.el):this.options.el,this.ens=".ajaxForm"+ ++s,this.deferreds=[],this.hasErrors=!1,this.options.preloaded?this.$form=this.$el.find(this.options.formSelector):this.deferreds.push(t.get(this.options.url,t.proxy(this.render,this))),this.events()},events:function(){this.$el.on("submit"+this.ens,this.options.formSelector,t.proxy(function(t){t.preventDefault(),this.postForm()},this))},postForm:function(s){var i=t.post(this.options.url,this.$form.serialize());return this.deferreds.push(i),t.when(i).done(t.proxy(function(t){s?this.hasErrors&&this.onSubmitSuccess(t):this.onSubmitSuccess(t)},this)).fail(t.proxy(function(t){t.status===this.options.validationErrorStatus?this.onValidationError(t.responseText):this.options.onSubmitFail&&this.options.onSubmitFail(t)},this)),i},render:function(t){this.$el.html(t),this.$form=this.$el.find(this.options.formSelector),this.options.afterRender&&this.options.afterRender(this.$form,this)},onSubmitSuccess:function(t){this.hasErrors=!1,this.options.onSubmitSuccess?this.options.onSubmitSuccess(t,this.$form,this):this.render(t),this.options.afterSubmitSuccess&&this.options.afterSubmitSuccess(t,this.$form,this)},onValidationError:function(t){this.hasErrors=!0,this.options.onValidationError?this.options.onValidationError(t,this.$form,this):this.render(t),this.options.afterValidationError&&this.options.afterValidationError(t,this.$form,this)},destroy:function(){this.$el.off(this.ens),t.each(this.deferreds,function(i,t){"pending"===t.state()&&t.abort()})}}),i.defaults={preloaded:!0,formSelector:"form",validationErrorStatus:400,afterRender:null,onValidationError:null,afterValidationError:null,onSubmitSuccess:null,afterSubmitSuccess:null,afterSubmitFail:null},t.wk=t.wk||{},t.wk.ajaxForm=i}(window.jQuery||window.Zepto);